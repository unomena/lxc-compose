# Example LXC Compose configuration with integrated syntax
# Port forwards and dependencies are now part of container configuration
#
# IMPORTANT: Container names must be globally unique across the system.
# Use project namespaces to avoid conflicts:
#   - myapp-db, myapp-cache, myapp-web
#   - com-example-db, com-example-app (reverse domain notation)

version: '1.0'

containers:
  myapp-db:
    template: ubuntu
    release: jammy
    
    # Port forwarding using Docker-like syntax
    ports:
      - 5432:5432  # PostgreSQL
    
    packages:
      - postgresql
      - postgresql-contrib
    
    environment:
      POSTGRES_USER: appuser
      POSTGRES_PASSWORD: apppass123
      POSTGRES_DB: appdb

  myapp-web:
    template: ubuntu  
    release: jammy
    
    # Simple dependency list
    depends_on:
      - myapp-db
    
    # Simple Docker-like mount syntax
    mounts:
      - .:/app                    # Current directory to /app
      - ./data:/data              # Relative path
      - /var/log/host:/var/log    # Absolute path
    
    # Port forwarding with optional descriptions
    ports:
      - 8080:80    # Web application
    
    packages:
      - python3
      - python3-pip
      - nginx
    
    environment:
      DATABASE_URL: postgresql://appuser:apppass123@myapp-db:5432/appdb
      DEBUG: "False"
      SECRET_KEY: "change-me-in-production"
    
    services:
      web:
        command: python3 /app/server.py
        directory: /app
        autostart: true
        autorestart: true